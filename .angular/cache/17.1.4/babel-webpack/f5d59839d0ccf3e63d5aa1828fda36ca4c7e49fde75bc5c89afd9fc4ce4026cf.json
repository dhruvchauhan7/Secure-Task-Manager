{"ast":null,"code":"import * as i0 from \"@angular/core\";\nexport class AuthService {\n  constructor() {\n    this.tokenKey = 'accessToken';\n  }\n  // token storage\n  setToken(token) {\n    localStorage.setItem(this.tokenKey, token);\n  }\n  getToken() {\n    return localStorage.getItem(this.tokenKey);\n  }\n  clear() {\n    localStorage.removeItem(this.tokenKey);\n  }\n  isLoggedIn() {\n    return !!this.getToken();\n  }\n  // decode helpers\n  decode(token) {\n    if (!token) return null;\n    try {\n      const [, payload] = token.split('.');\n      const json = atob(payload.replace(/-/g, '+').replace(/_/g, '/'));\n      return JSON.parse(json);\n    } catch {\n      return null;\n    }\n  }\n  getUser() {\n    return this.decode(this.getToken());\n  }\n  getRole() {\n    return this.getUser()?.role;\n  }\n  canWrite() {\n    const role = this.getRole();\n    return role === 'OWNER' || role === 'ADMIN';\n  }\n  static {\n    this.ɵfac = function AuthService_Factory(t) {\n      return new (t || AuthService)();\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: AuthService,\n      factory: AuthService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["AuthService","constructor","tokenKey","setToken","token","localStorage","setItem","getToken","getItem","clear","removeItem","isLoggedIn","decode","payload","split","json","atob","replace","JSON","parse","getUser","getRole","role","canWrite","factory","ɵfac","providedIn"],"sources":["E:\\Practice\\secure-task-manager\\apps\\dashboard\\src\\app\\auth\\auth.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\n\r\nexport type Role = 'OWNER' | 'ADMIN' | 'VIEWER';\r\n\r\nexport type JwtPayload = {\r\n  sub?: string;\r\n  userId?: string;\r\n  email?: string;\r\n  role?: Role;\r\n  orgId?: string;\r\n  iat?: number;\r\n  exp?: number;\r\n};\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class AuthService {\r\n  private tokenKey = 'accessToken';\r\n\r\n  // token storage\r\n  setToken(token: string) {\r\n    localStorage.setItem(this.tokenKey, token);\r\n  }\r\n\r\n  getToken(): string | null {\r\n    return localStorage.getItem(this.tokenKey);\r\n  }\r\n\r\n  clear() {\r\n    localStorage.removeItem(this.tokenKey);\r\n  }\r\n\r\n  isLoggedIn(): boolean {\r\n    return !!this.getToken();\r\n  }\r\n\r\n  // decode helpers\r\n  private decode(token: string | null): JwtPayload | null {\r\n    if (!token) return null;\r\n    try {\r\n      const [, payload] = token.split('.');\r\n      const json = atob(payload.replace(/-/g, '+').replace(/_/g, '/'));\r\n      return JSON.parse(json);\r\n    } catch {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  getUser(): JwtPayload | null {\r\n    return this.decode(this.getToken());\r\n  }\r\n\r\n  getRole(): Role | undefined {\r\n    return this.getUser()?.role;\r\n  }\r\n\r\n  canWrite(): boolean {\r\n    const role = this.getRole();\r\n    return role === 'OWNER' || role === 'ADMIN';\r\n  }\r\n}\r\n"],"mappings":";AAeA,OAAM,MAAOA,WAAW;EADxBC,YAAA;IAEU,KAAAC,QAAQ,GAAG,aAAa;;EAEhC;EACAC,QAAQA,CAACC,KAAa;IACpBC,YAAY,CAACC,OAAO,CAAC,IAAI,CAACJ,QAAQ,EAAEE,KAAK,CAAC;EAC5C;EAEAG,QAAQA,CAAA;IACN,OAAOF,YAAY,CAACG,OAAO,CAAC,IAAI,CAACN,QAAQ,CAAC;EAC5C;EAEAO,KAAKA,CAAA;IACHJ,YAAY,CAACK,UAAU,CAAC,IAAI,CAACR,QAAQ,CAAC;EACxC;EAEAS,UAAUA,CAAA;IACR,OAAO,CAAC,CAAC,IAAI,CAACJ,QAAQ,EAAE;EAC1B;EAEA;EACQK,MAAMA,CAACR,KAAoB;IACjC,IAAI,CAACA,KAAK,EAAE,OAAO,IAAI;IACvB,IAAI;MACF,MAAM,GAAGS,OAAO,CAAC,GAAGT,KAAK,CAACU,KAAK,CAAC,GAAG,CAAC;MACpC,MAAMC,IAAI,GAAGC,IAAI,CAACH,OAAO,CAACI,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAACA,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;MAChE,OAAOC,IAAI,CAACC,KAAK,CAACJ,IAAI,CAAC;IACzB,CAAC,CAAC,MAAM;MACN,OAAO,IAAI;IACb;EACF;EAEAK,OAAOA,CAAA;IACL,OAAO,IAAI,CAACR,MAAM,CAAC,IAAI,CAACL,QAAQ,EAAE,CAAC;EACrC;EAEAc,OAAOA,CAAA;IACL,OAAO,IAAI,CAACD,OAAO,EAAE,EAAEE,IAAI;EAC7B;EAEAC,QAAQA,CAAA;IACN,MAAMD,IAAI,GAAG,IAAI,CAACD,OAAO,EAAE;IAC3B,OAAOC,IAAI,KAAK,OAAO,IAAIA,IAAI,KAAK,OAAO;EAC7C;;;uBA3CWtB,WAAW;IAAA;EAAA;;;aAAXA,WAAW;MAAAwB,OAAA,EAAXxB,WAAW,CAAAyB,IAAA;MAAAC,UAAA,EADE;IAAM;EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
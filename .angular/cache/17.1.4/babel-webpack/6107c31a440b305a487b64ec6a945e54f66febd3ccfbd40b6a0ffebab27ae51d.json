{"ast":null,"code":"import _asyncToGenerator from \"E:/Practice/secure-task-manager/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction TasksComponent_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 23);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r0.error);\n  }\n}\nfunction TasksComponent_div_42_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 11);\n    i0.ɵɵtext(1, \"Loading tasks\\u2026\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TasksComponent_div_43_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 11);\n    i0.ɵɵtext(1, \"No tasks yet.\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TasksComponent_div_44_article_1_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 32);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const t_r5 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(t_r5.description);\n  }\n}\nconst _c0 = (a0, a1, a2) => ({\n  \"badge-open\": a0,\n  \"badge-inprogress\": a1,\n  \"badge-done\": a2\n});\nfunction TasksComponent_div_44_article_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"article\", 26)(1, \"div\", 27)(2, \"div\", 28);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"span\", 29);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(6, TasksComponent_div_44_article_1_div_6_Template, 2, 1, \"div\", 30);\n    i0.ɵɵelementStart(7, \"div\", 31)(8, \"span\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"span\");\n    i0.ɵɵtext(11, \"\\u2022\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"span\");\n    i0.ɵɵtext(13);\n    i0.ɵɵpipe(14, \"date\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const t_r5 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(t_r5.title);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction3(9, _c0, t_r5.status === \"OPEN\", t_r5.status === \"IN_PROGRESS\", t_r5.status === \"DONE\"));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", t_r5.status, \" \");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", t_r5.description);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"Created by \", t_r5.createdByEmail, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(14, 6, t_r5.createdAt, \"medium\"));\n  }\n}\nfunction TasksComponent_div_44_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 24);\n    i0.ɵɵtemplate(1, TasksComponent_div_44_article_1_Template, 15, 13, \"article\", 25);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.tasks);\n  }\n}\nexport class TasksComponent {\n  constructor(http) {\n    this.http = http;\n    this.API = 'http://localhost:3000/api';\n    this.tasks = [];\n    // create form\n    this.title = '';\n    this.description = '';\n    this.status = 'OPEN';\n    // ui state\n    this.loading = false;\n    this.creating = false;\n    this.error = '';\n    // role + user\n    this.me = null;\n    // editing state\n    this.editingId = null;\n    this.editTitle = '';\n    this.editDescription = '';\n    this.editStatus = 'OPEN';\n    this.savingId = null;\n    this.deletingId = null;\n  }\n  ngOnInit() {\n    this.me = this.decodeToken();\n    this.load();\n  }\n  get canWrite() {\n    return this.me?.role === 'OWNER' || this.me?.role === 'ADMIN';\n  }\n  refresh() {\n    this.load();\n  }\n  authHeaders() {\n    const token = localStorage.getItem('accessToken') ?? '';\n    return new HttpHeaders({\n      Authorization: `Bearer ${token}`\n    });\n  }\n  decodeToken() {\n    const token = localStorage.getItem('accessToken');\n    if (!token) return null;\n    try {\n      const middle = token.split('.')[1];\n      const json = atob(middle.replace(/-/g, '+').replace(/_/g, '/'));\n      return JSON.parse(json);\n    } catch {\n      return null;\n    }\n  }\n  load() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      _this.error = '';\n      _this.loading = true;\n      try {\n        const headers = _this.authHeaders();\n        const res = yield _this.http.get(`${_this.API}/tasks`, {\n          headers\n        }).toPromise();\n        _this.tasks = res ?? [];\n      } catch (e) {\n        _this.error = e?.status === 401 ? 'Unauthorized (please login again).' : 'Failed to load tasks.';\n        _this.tasks = [];\n      } finally {\n        _this.loading = false;\n      }\n    })();\n  }\n  create() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      _this2.error = '';\n      if (!_this2.canWrite) {\n        _this2.error = 'You do not have permission to create tasks.';\n        return;\n      }\n      const title = _this2.title.trim();\n      if (!title) return;\n      _this2.creating = true;\n      try {\n        const headers = _this2.authHeaders();\n        const created = yield _this2.http.post(`${_this2.API}/tasks`, {\n          title,\n          description: _this2.description.trim() || undefined,\n          status: _this2.status\n        }, {\n          headers\n        }).toPromise();\n        if (created) _this2.tasks = [created, ..._this2.tasks];\n        _this2.title = '';\n        _this2.description = '';\n        _this2.status = 'OPEN';\n      } catch (e) {\n        _this2.error = e?.status === 401 ? 'Unauthorized (please login again).' : 'Failed to create task.';\n      } finally {\n        _this2.creating = false;\n      }\n    })();\n  }\n  startEdit(t) {\n    if (!this.canWrite) return;\n    this.editingId = t.id;\n    this.editTitle = t.title ?? '';\n    this.editDescription = t.description ?? '';\n    this.editStatus = t.status;\n  }\n  cancelEdit() {\n    this.editingId = null;\n    this.editTitle = '';\n    this.editDescription = '';\n    this.editStatus = 'OPEN';\n  }\n  saveEdit(id) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      _this3.error = '';\n      if (!_this3.canWrite) {\n        _this3.error = 'You do not have permission to edit tasks.';\n        return;\n      }\n      const title = _this3.editTitle.trim();\n      if (!title) {\n        _this3.error = 'Title cannot be empty.';\n        return;\n      }\n      _this3.savingId = id;\n      try {\n        const headers = _this3.authHeaders();\n        const updated = yield _this3.http.patch(`${_this3.API}/tasks/${id}`, {\n          title,\n          description: _this3.editDescription.trim() || undefined,\n          status: _this3.editStatus\n        }, {\n          headers\n        }).toPromise();\n        if (updated) {\n          _this3.tasks = _this3.tasks.map(t => t.id === id ? updated : t);\n        }\n        _this3.cancelEdit();\n      } catch (e) {\n        _this3.error = e?.status === 401 ? 'Unauthorized (please login again).' : e?.status === 403 ? 'Forbidden (role does not allow editing).' : 'Failed to update task.';\n      } finally {\n        _this3.savingId = null;\n      }\n    })();\n  }\n  remove(id) {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      _this4.error = '';\n      if (!_this4.canWrite) {\n        _this4.error = 'You do not have permission to delete tasks.';\n        return;\n      }\n      const ok = confirm('Delete this task?');\n      if (!ok) return;\n      _this4.deletingId = id;\n      try {\n        const headers = _this4.authHeaders();\n        yield _this4.http.delete(`${_this4.API}/tasks/${id}`, {\n          headers\n        }).toPromise();\n        _this4.tasks = _this4.tasks.filter(t => t.id !== id);\n      } catch (e) {\n        _this4.error = e?.status === 401 ? 'Unauthorized (please login again).' : e?.status === 403 ? 'Forbidden (role does not allow deleting).' : 'Failed to delete task.';\n      } finally {\n        _this4.deletingId = null;\n      }\n    })();\n  }\n  static {\n    this.ɵfac = function TasksComponent_Factory(t) {\n      return new (t || TasksComponent)(i0.ɵɵdirectiveInject(i1.HttpClient));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: TasksComponent,\n      selectors: [[\"stm-tasks\"]],\n      standalone: true,\n      features: [i0.ɵɵStandaloneFeature],\n      decls: 45,\n      vars: 10,\n      consts: [[1, \"page\"], [1, \"page__head\"], [1, \"h1\"], [1, \"muted\", 2, \"margin-top\", \"6px\"], [1, \"page__actions\"], [1, \"btn\", \"btn-secondary\", 3, \"click\"], [\"class\", \"error\", \"style\", \"margin-top: 14px\", 4, \"ngIf\"], [1, \"grid\"], [1, \"card\", \"panel\"], [1, \"panel__title\"], [1, \"h2\"], [1, \"muted\"], [1, \"form\"], [1, \"label\"], [\"name\", \"title\", 1, \"input\", 3, \"ngModel\", \"ngModelChange\"], [\"name\", \"description\", 1, \"input\", 3, \"ngModel\", \"ngModelChange\"], [\"name\", \"status\", 1, \"select\", 3, \"ngModel\", \"ngModelChange\"], [\"value\", \"OPEN\"], [\"value\", \"IN_PROGRESS\"], [\"value\", \"DONE\"], [1, \"btn\", 3, \"disabled\", \"click\"], [\"class\", \"muted\", 4, \"ngIf\"], [\"class\", \"list\", 4, \"ngIf\"], [1, \"error\", 2, \"margin-top\", \"14px\"], [1, \"list\"], [\"class\", \"task\", 4, \"ngFor\", \"ngForOf\"], [1, \"task\"], [1, \"task__top\"], [1, \"task__title\"], [1, \"badge\", 3, \"ngClass\"], [\"class\", \"task__desc muted\", 4, \"ngIf\"], [1, \"task__meta\", \"muted\"], [1, \"task__desc\", \"muted\"]],\n      template: function TasksComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"section\", 0)(1, \"div\", 1)(2, \"div\")(3, \"h1\", 2);\n          i0.ɵɵtext(4, \"Tasks\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(5, \"div\", 3);\n          i0.ɵɵtext(6, \" Create, view, and manage tasks within your org. \");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(7, \"div\", 4)(8, \"button\", 5);\n          i0.ɵɵlistener(\"click\", function TasksComponent_Template_button_click_8_listener() {\n            return ctx.refresh();\n          });\n          i0.ɵɵtext(9, \"Refresh\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵtemplate(10, TasksComponent_div_10_Template, 2, 1, \"div\", 6);\n          i0.ɵɵelementStart(11, \"div\", 7)(12, \"div\", 8)(13, \"div\", 9)(14, \"div\", 10);\n          i0.ɵɵtext(15, \"Create task\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(16, \"span\", 11);\n          i0.ɵɵtext(17, \"OWNER/ADMIN only\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(18, \"div\", 12)(19, \"label\", 13);\n          i0.ɵɵtext(20, \" Title \");\n          i0.ɵɵelementStart(21, \"input\", 14);\n          i0.ɵɵlistener(\"ngModelChange\", function TasksComponent_Template_input_ngModelChange_21_listener($event) {\n            return ctx.title = $event;\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(22, \"label\", 13);\n          i0.ɵɵtext(23, \" Description \");\n          i0.ɵɵelementStart(24, \"input\", 15);\n          i0.ɵɵlistener(\"ngModelChange\", function TasksComponent_Template_input_ngModelChange_24_listener($event) {\n            return ctx.description = $event;\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(25, \"label\", 13);\n          i0.ɵɵtext(26, \" Status \");\n          i0.ɵɵelementStart(27, \"select\", 16);\n          i0.ɵɵlistener(\"ngModelChange\", function TasksComponent_Template_select_ngModelChange_27_listener($event) {\n            return ctx.status = $event;\n          });\n          i0.ɵɵelementStart(28, \"option\", 17);\n          i0.ɵɵtext(29, \"OPEN\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(30, \"option\", 18);\n          i0.ɵɵtext(31, \"IN_PROGRESS\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(32, \"option\", 19);\n          i0.ɵɵtext(33, \"DONE\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(34, \"button\", 20);\n          i0.ɵɵlistener(\"click\", function TasksComponent_Template_button_click_34_listener() {\n            return ctx.create();\n          });\n          i0.ɵɵtext(35);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(36, \"div\", 8)(37, \"div\", 9)(38, \"div\", 10);\n          i0.ɵɵtext(39, \"Task list\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(40, \"span\", 11);\n          i0.ɵɵtext(41);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(42, TasksComponent_div_42_Template, 2, 0, \"div\", 21)(43, TasksComponent_div_43_Template, 2, 0, \"div\", 21)(44, TasksComponent_div_44_Template, 2, 1, \"div\", 22);\n          i0.ɵɵelementEnd()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(10);\n          i0.ɵɵproperty(\"ngIf\", ctx.error);\n          i0.ɵɵadvance(11);\n          i0.ɵɵproperty(\"ngModel\", ctx.title);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngModel\", ctx.description);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngModel\", ctx.status);\n          i0.ɵɵadvance(7);\n          i0.ɵɵproperty(\"disabled\", ctx.creating || !ctx.title.trim());\n          i0.ɵɵadvance();\n          i0.ɵɵtextInterpolate1(\" \", ctx.creating ? \"Creating\\u2026\" : \"Create task\", \" \");\n          i0.ɵɵadvance(6);\n          i0.ɵɵtextInterpolate1(\"\", ctx.tasks.length, \" total\");\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.loading);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", !ctx.loading && ctx.tasks.length === 0);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", !ctx.loading && ctx.tasks.length);\n        }\n      },\n      dependencies: [CommonModule, i2.NgClass, i2.NgForOf, i2.NgIf, i2.DatePipe, FormsModule, i3.NgSelectOption, i3.ɵNgSelectMultipleOption, i3.DefaultValueAccessor, i3.SelectControlValueAccessor, i3.NgControlStatus, i3.NgModel],\n      styles: [\".page[_ngcontent-%COMP%] { padding: 6px; }\\n\\n.page__head[_ngcontent-%COMP%] {\\n  display: flex;\\n  align-items: flex-end;\\n  justify-content: space-between;\\n  gap: 12px;\\n}\\n\\n.page__actions[_ngcontent-%COMP%] { display: flex; gap: 10px; align-items: center; }\\n\\n.grid[_ngcontent-%COMP%] {\\n  margin-top: 16px;\\n  display: grid;\\n  grid-template-columns: 1fr 1.4fr;\\n  gap: 16px;\\n  align-items: start;\\n}\\n\\n.panel[_ngcontent-%COMP%] { padding: 16px; }\\n.panel__title[_ngcontent-%COMP%] {\\n  display: flex;\\n  align-items: baseline;\\n  justify-content: space-between;\\n  margin-bottom: 12px;\\n  gap: 10px;\\n}\\n\\n.form[_ngcontent-%COMP%] { display: grid; gap: 12px; }\\n.label[_ngcontent-%COMP%] { display: grid; gap: 6px; font-weight: 600; color: #334155; }\\n\\n.list[_ngcontent-%COMP%] { display: grid; gap: 12px; margin-top: 10px; }\\n\\n.task[_ngcontent-%COMP%] {\\n  padding: 14px;\\n  border-radius: 14px;\\n  border: 1px solid rgba(15, 23, 42, 0.08);\\n  background: rgba(255, 255, 255, 0.75);\\n}\\n\\n.task__top[_ngcontent-%COMP%] {\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n  gap: 10px;\\n}\\n.task__title[_ngcontent-%COMP%] { font-weight: 800; letter-spacing: -0.01em; }\\n.task__desc[_ngcontent-%COMP%] { margin-top: 6px; }\\n.task__meta[_ngcontent-%COMP%] { margin-top: 10px; font-size: 12px; display: flex; gap: 8px; flex-wrap: wrap; }\\n\\n\\n\\n@media (max-width: 920px) {\\n  .grid[_ngcontent-%COMP%] { grid-template-columns: 1fr; }\\n  .page__head[_ngcontent-%COMP%] { flex-direction: column; align-items: stretch; }\\n  .page__actions[_ngcontent-%COMP%] { justify-content: flex-start; }\\n}\\n\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL2FwcHMvZGFzaGJvYXJkL3NyYy9hcHAvdGFza3MvdGFza3MuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxRQUFRLFlBQVksRUFBRTs7QUFFdEI7RUFDRSxhQUFhO0VBQ2IscUJBQXFCO0VBQ3JCLDhCQUE4QjtFQUM5QixTQUFTO0FBQ1g7O0FBRUEsaUJBQWlCLGFBQWEsRUFBRSxTQUFTLEVBQUUsbUJBQW1CLEVBQUU7O0FBRWhFO0VBQ0UsZ0JBQWdCO0VBQ2hCLGFBQWE7RUFDYixnQ0FBZ0M7RUFDaEMsU0FBUztFQUNULGtCQUFrQjtBQUNwQjs7QUFFQSxTQUFTLGFBQWEsRUFBRTtBQUN4QjtFQUNFLGFBQWE7RUFDYixxQkFBcUI7RUFDckIsOEJBQThCO0VBQzlCLG1CQUFtQjtFQUNuQixTQUFTO0FBQ1g7O0FBRUEsUUFBUSxhQUFhLEVBQUUsU0FBUyxFQUFFO0FBQ2xDLFNBQVMsYUFBYSxFQUFFLFFBQVEsRUFBRSxnQkFBZ0IsRUFBRSxjQUFjLEVBQUU7O0FBRXBFLFFBQVEsYUFBYSxFQUFFLFNBQVMsRUFBRSxnQkFBZ0IsRUFBRTs7QUFFcEQ7RUFDRSxhQUFhO0VBQ2IsbUJBQW1CO0VBQ25CLHdDQUF3QztFQUN4QyxxQ0FBcUM7QUFDdkM7O0FBRUE7RUFDRSxhQUFhO0VBQ2IsbUJBQW1CO0VBQ25CLDhCQUE4QjtFQUM5QixTQUFTO0FBQ1g7QUFDQSxlQUFlLGdCQUFnQixFQUFFLHVCQUF1QixFQUFFO0FBQzFELGNBQWMsZUFBZSxFQUFFO0FBQy9CLGNBQWMsZ0JBQWdCLEVBQUUsZUFBZSxFQUFFLGFBQWEsRUFBRSxRQUFRLEVBQUUsZUFBZSxFQUFFOztBQUUzRixlQUFlO0FBQ2Y7RUFDRSxRQUFRLDBCQUEwQixFQUFFO0VBQ3BDLGNBQWMsc0JBQXNCLEVBQUUsb0JBQW9CLEVBQUU7RUFDNUQsaUJBQWlCLDJCQUEyQixFQUFFO0FBQ2hEIiwic291cmNlc0NvbnRlbnQiOlsiLnBhZ2UgeyBwYWRkaW5nOiA2cHg7IH1cclxuXHJcbi5wYWdlX19oZWFkIHtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIGFsaWduLWl0ZW1zOiBmbGV4LWVuZDtcclxuICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XHJcbiAgZ2FwOiAxMnB4O1xyXG59XHJcblxyXG4ucGFnZV9fYWN0aW9ucyB7IGRpc3BsYXk6IGZsZXg7IGdhcDogMTBweDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgfVxyXG5cclxuLmdyaWQge1xyXG4gIG1hcmdpbi10b3A6IDE2cHg7XHJcbiAgZGlzcGxheTogZ3JpZDtcclxuICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciAxLjRmcjtcclxuICBnYXA6IDE2cHg7XHJcbiAgYWxpZ24taXRlbXM6IHN0YXJ0O1xyXG59XHJcblxyXG4ucGFuZWwgeyBwYWRkaW5nOiAxNnB4OyB9XHJcbi5wYW5lbF9fdGl0bGUge1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgYWxpZ24taXRlbXM6IGJhc2VsaW5lO1xyXG4gIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcclxuICBtYXJnaW4tYm90dG9tOiAxMnB4O1xyXG4gIGdhcDogMTBweDtcclxufVxyXG5cclxuLmZvcm0geyBkaXNwbGF5OiBncmlkOyBnYXA6IDEycHg7IH1cclxuLmxhYmVsIHsgZGlzcGxheTogZ3JpZDsgZ2FwOiA2cHg7IGZvbnQtd2VpZ2h0OiA2MDA7IGNvbG9yOiAjMzM0MTU1OyB9XHJcblxyXG4ubGlzdCB7IGRpc3BsYXk6IGdyaWQ7IGdhcDogMTJweDsgbWFyZ2luLXRvcDogMTBweDsgfVxyXG5cclxuLnRhc2sge1xyXG4gIHBhZGRpbmc6IDE0cHg7XHJcbiAgYm9yZGVyLXJhZGl1czogMTRweDtcclxuICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDE1LCAyMywgNDIsIDAuMDgpO1xyXG4gIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC43NSk7XHJcbn1cclxuXHJcbi50YXNrX190b3Age1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XHJcbiAgZ2FwOiAxMHB4O1xyXG59XHJcbi50YXNrX190aXRsZSB7IGZvbnQtd2VpZ2h0OiA4MDA7IGxldHRlci1zcGFjaW5nOiAtMC4wMWVtOyB9XHJcbi50YXNrX19kZXNjIHsgbWFyZ2luLXRvcDogNnB4OyB9XHJcbi50YXNrX19tZXRhIHsgbWFyZ2luLXRvcDogMTBweDsgZm9udC1zaXplOiAxMnB4OyBkaXNwbGF5OiBmbGV4OyBnYXA6IDhweDsgZmxleC13cmFwOiB3cmFwOyB9XHJcblxyXG4vKiBSZXNwb25zaXZlICovXHJcbkBtZWRpYSAobWF4LXdpZHRoOiA5MjBweCkge1xyXG4gIC5ncmlkIHsgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnI7IH1cclxuICAucGFnZV9faGVhZCB7IGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47IGFsaWduLWl0ZW1zOiBzdHJldGNoOyB9XHJcbiAgLnBhZ2VfX2FjdGlvbnMgeyBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtc3RhcnQ7IH1cclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n    });\n  }\n}","map":{"version":3,"names":["CommonModule","FormsModule","HttpClient","HttpHeaders","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵtextInterpolate","ctx_r0","error","t_r5","description","ɵɵtemplate","TasksComponent_div_44_article_1_div_6_Template","title","ɵɵproperty","ɵɵpureFunction3","_c0","status","ɵɵtextInterpolate1","createdByEmail","ɵɵpipeBind2","createdAt","TasksComponent_div_44_article_1_Template","ctx_r3","tasks","TasksComponent","constructor","http","API","loading","creating","me","editingId","editTitle","editDescription","editStatus","savingId","deletingId","ngOnInit","decodeToken","load","canWrite","role","refresh","authHeaders","token","localStorage","getItem","Authorization","middle","split","json","atob","replace","JSON","parse","_this","_asyncToGenerator","headers","res","get","toPromise","e","create","_this2","trim","created","post","undefined","startEdit","t","id","cancelEdit","saveEdit","_this3","updated","patch","map","remove","_this4","ok","confirm","delete","filter","ɵɵdirectiveInject","i1","selectors","standalone","features","ɵɵStandaloneFeature","decls","vars","consts","template","TasksComponent_Template","rf","ctx","ɵɵlistener","TasksComponent_Template_button_click_8_listener","TasksComponent_div_10_Template","TasksComponent_Template_input_ngModelChange_21_listener","$event","TasksComponent_Template_input_ngModelChange_24_listener","TasksComponent_Template_select_ngModelChange_27_listener","TasksComponent_Template_button_click_34_listener","TasksComponent_div_42_Template","TasksComponent_div_43_Template","TasksComponent_div_44_Template","length","i2","NgClass","NgForOf","NgIf","DatePipe","i3","NgSelectOption","ɵNgSelectMultipleOption","DefaultValueAccessor","SelectControlValueAccessor","NgControlStatus","NgModel","styles"],"sources":["E:\\Practice\\secure-task-manager\\apps\\dashboard\\src\\app\\tasks\\tasks.component.ts","E:\\Practice\\secure-task-manager\\apps\\dashboard\\src\\app\\tasks\\tasks.component.html"],"sourcesContent":["import { CommonModule } from '@angular/common';\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\r\n\r\ntype Role = 'OWNER' | 'ADMIN' | 'VIEWER';\r\ntype TaskStatus = 'OPEN' | 'IN_PROGRESS' | 'DONE';\r\n\r\ntype Task = {\r\n  id: string;\r\n  orgId: string;\r\n  title: string;\r\n  description?: string | null;\r\n  status: TaskStatus;\r\n  createdByEmail: string;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n};\r\n\r\ntype JwtPayload = {\r\n  sub: string;\r\n  email: string;\r\n  role: Role;\r\n  orgId: string;\r\n  iat: number;\r\n  exp: number;\r\n};\r\n\r\n@Component({\r\n  selector: 'stm-tasks',\r\n  standalone: true,\r\n  imports: [CommonModule, FormsModule],\r\n  templateUrl: './tasks.component.html',\r\n  styleUrl: './tasks.component.css',\r\n})\r\nexport class TasksComponent implements OnInit {\r\n  private readonly API = 'http://localhost:3000/api';\r\n\r\n  tasks: Task[] = [];\r\n\r\n  // create form\r\n  title = '';\r\n  description = '';\r\n  status: TaskStatus = 'OPEN';\r\n\r\n  // ui state\r\n  loading = false;\r\n  creating = false;\r\n  error = '';\r\n\r\n  // role + user\r\n  me: JwtPayload | null = null;\r\n\r\n  // editing state\r\n  editingId: string | null = null;\r\n  editTitle = '';\r\n  editDescription = '';\r\n  editStatus: TaskStatus = 'OPEN';\r\n  savingId: string | null = null;\r\n  deletingId: string | null = null;\r\n\r\n  constructor(private readonly http: HttpClient) {}\r\n\r\n  ngOnInit(): void {\r\n    this.me = this.decodeToken();\r\n    this.load();\r\n  }\r\n\r\n  get canWrite(): boolean {\r\n    return this.me?.role === 'OWNER' || this.me?.role === 'ADMIN';\r\n  }\r\n\r\n  refresh(): void {\r\n    this.load();\r\n  }\r\n\r\n  private authHeaders(): HttpHeaders {\r\n    const token = localStorage.getItem('accessToken') ?? '';\r\n    return new HttpHeaders({ Authorization: `Bearer ${token}` });\r\n  }\r\n\r\n  private decodeToken(): JwtPayload | null {\r\n    const token = localStorage.getItem('accessToken');\r\n    if (!token) return null;\r\n\r\n    try {\r\n      const middle = token.split('.')[1];\r\n      const json = atob(middle.replace(/-/g, '+').replace(/_/g, '/'));\r\n      return JSON.parse(json) as JwtPayload;\r\n    } catch {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  async load(): Promise<void> {\r\n    this.error = '';\r\n    this.loading = true;\r\n\r\n    try {\r\n      const headers = this.authHeaders();\r\n      const res = await this.http.get<Task[]>(`${this.API}/tasks`, { headers }).toPromise();\r\n      this.tasks = res ?? [];\r\n    } catch (e: any) {\r\n      this.error = e?.status === 401 ? 'Unauthorized (please login again).' : 'Failed to load tasks.';\r\n      this.tasks = [];\r\n    } finally {\r\n      this.loading = false;\r\n    }\r\n  }\r\n\r\n  async create(): Promise<void> {\r\n    this.error = '';\r\n    if (!this.canWrite) {\r\n      this.error = 'You do not have permission to create tasks.';\r\n      return;\r\n    }\r\n\r\n    const title = this.title.trim();\r\n    if (!title) return;\r\n\r\n    this.creating = true;\r\n\r\n    try {\r\n      const headers = this.authHeaders();\r\n      const created = await this.http\r\n        .post<Task>(\r\n          `${this.API}/tasks`,\r\n          {\r\n            title,\r\n            description: this.description.trim() || undefined,\r\n            status: this.status,\r\n          },\r\n          { headers }\r\n        )\r\n        .toPromise();\r\n\r\n      if (created) this.tasks = [created, ...this.tasks];\r\n\r\n      this.title = '';\r\n      this.description = '';\r\n      this.status = 'OPEN';\r\n    } catch (e: any) {\r\n      this.error = e?.status === 401 ? 'Unauthorized (please login again).' : 'Failed to create task.';\r\n    } finally {\r\n      this.creating = false;\r\n    }\r\n  }\r\n\r\n  startEdit(t: Task): void {\r\n    if (!this.canWrite) return;\r\n\r\n    this.editingId = t.id;\r\n    this.editTitle = t.title ?? '';\r\n    this.editDescription = (t.description ?? '') as string;\r\n    this.editStatus = t.status;\r\n  }\r\n\r\n  cancelEdit(): void {\r\n    this.editingId = null;\r\n    this.editTitle = '';\r\n    this.editDescription = '';\r\n    this.editStatus = 'OPEN';\r\n  }\r\n\r\n  async saveEdit(id: string): Promise<void> {\r\n    this.error = '';\r\n    if (!this.canWrite) {\r\n      this.error = 'You do not have permission to edit tasks.';\r\n      return;\r\n    }\r\n\r\n    const title = this.editTitle.trim();\r\n    if (!title) {\r\n      this.error = 'Title cannot be empty.';\r\n      return;\r\n    }\r\n\r\n    this.savingId = id;\r\n\r\n    try {\r\n      const headers = this.authHeaders();\r\n      const updated = await this.http\r\n        .patch<Task>(\r\n          `${this.API}/tasks/${id}`,\r\n          {\r\n            title,\r\n            description: this.editDescription.trim() || undefined,\r\n            status: this.editStatus,\r\n          },\r\n          { headers }\r\n        )\r\n        .toPromise();\r\n\r\n      if (updated) {\r\n        this.tasks = this.tasks.map((t) => (t.id === id ? updated : t));\r\n      }\r\n\r\n      this.cancelEdit();\r\n    } catch (e: any) {\r\n      this.error =\r\n        e?.status === 401\r\n          ? 'Unauthorized (please login again).'\r\n          : e?.status === 403\r\n          ? 'Forbidden (role does not allow editing).'\r\n          : 'Failed to update task.';\r\n    } finally {\r\n      this.savingId = null;\r\n    }\r\n  }\r\n\r\n  async remove(id: string): Promise<void> {\r\n    this.error = '';\r\n    if (!this.canWrite) {\r\n      this.error = 'You do not have permission to delete tasks.';\r\n      return;\r\n    }\r\n\r\n    const ok = confirm('Delete this task?');\r\n    if (!ok) return;\r\n\r\n    this.deletingId = id;\r\n\r\n    try {\r\n      const headers = this.authHeaders();\r\n      await this.http.delete(`${this.API}/tasks/${id}`, { headers }).toPromise();\r\n      this.tasks = this.tasks.filter((t) => t.id !== id);\r\n    } catch (e: any) {\r\n      this.error =\r\n        e?.status === 401\r\n          ? 'Unauthorized (please login again).'\r\n          : e?.status === 403\r\n          ? 'Forbidden (role does not allow deleting).'\r\n          : 'Failed to delete task.';\r\n    } finally {\r\n      this.deletingId = null;\r\n    }\r\n  }\r\n}\r\n","<section class=\"page\">\r\n    <div class=\"page__head\">\r\n      <div>\r\n        <h1 class=\"h1\">Tasks</h1>\r\n        <div class=\"muted\" style=\"margin-top: 6px\">\r\n          Create, view, and manage tasks within your org.\r\n        </div>\r\n      </div>\r\n  \r\n      <div class=\"page__actions\">\r\n        <button class=\"btn btn-secondary\" (click)=\"refresh()\">Refresh</button>\r\n      </div>\r\n    </div>\r\n  \r\n    <div *ngIf=\"error\" class=\"error\" style=\"margin-top: 14px\">{{ error }}</div>\r\n  \r\n    <div class=\"grid\">\r\n      <div class=\"card panel\">\r\n        <div class=\"panel__title\">\r\n          <div class=\"h2\">Create task</div>\r\n          <span class=\"muted\">OWNER/ADMIN only</span>\r\n        </div>\r\n  \r\n        <div class=\"form\">\r\n          <label class=\"label\">\r\n            Title\r\n            <input class=\"input\" [(ngModel)]=\"title\" name=\"title\" />\r\n          </label>\r\n  \r\n          <label class=\"label\">\r\n            Description\r\n            <input class=\"input\" [(ngModel)]=\"description\" name=\"description\" />\r\n          </label>\r\n  \r\n          <label class=\"label\">\r\n            Status\r\n            <select class=\"select\" [(ngModel)]=\"status\" name=\"status\">\r\n              <option value=\"OPEN\">OPEN</option>\r\n              <option value=\"IN_PROGRESS\">IN_PROGRESS</option>\r\n              <option value=\"DONE\">DONE</option>\r\n            </select>\r\n          </label>\r\n  \r\n          <button class=\"btn\" (click)=\"create()\" [disabled]=\"creating || !title.trim()\">\r\n            {{ creating ? 'Creating…' : 'Create task' }}\r\n          </button>\r\n        </div>\r\n      </div>\r\n  \r\n      <div class=\"card panel\">\r\n        <div class=\"panel__title\">\r\n          <div class=\"h2\">Task list</div>\r\n          <span class=\"muted\">{{ tasks.length }} total</span>\r\n        </div>\r\n  \r\n        <div *ngIf=\"loading\" class=\"muted\">Loading tasks…</div>\r\n  \r\n        <div *ngIf=\"!loading && tasks.length === 0\" class=\"muted\">No tasks yet.</div>\r\n  \r\n        <div class=\"list\" *ngIf=\"!loading && tasks.length\">\r\n          <article class=\"task\" *ngFor=\"let t of tasks\">\r\n            <div class=\"task__top\">\r\n              <div class=\"task__title\">{{ t.title }}</div>\r\n              <span class=\"badge\"\r\n                [ngClass]=\"{\r\n                  'badge-open': t.status === 'OPEN',\r\n                  'badge-inprogress': t.status === 'IN_PROGRESS',\r\n                  'badge-done': t.status === 'DONE'\r\n                }\">\r\n                {{ t.status }}\r\n              </span>\r\n            </div>\r\n  \r\n            <div class=\"task__desc muted\" *ngIf=\"t.description\">{{ t.description }}</div>\r\n  \r\n            <div class=\"task__meta muted\">\r\n              <span>Created by {{ t.createdByEmail }}</span>\r\n              <span>•</span>\r\n              <span>{{ t.createdAt | date: 'medium' }}</span>\r\n            </div>\r\n          </article>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </section>\r\n  "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}